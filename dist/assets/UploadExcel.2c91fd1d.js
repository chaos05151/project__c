import{q as ae,s as le,_ as oe,r as _,u as ne,a as se,c as r,o as h,d as C,e as d,f as a,w as s,i as p,n as ue,b as x,F as N,x as T,y as q,t as ce,p as re,j as ie}from"./index.350a3b31.js";import{b as de,c as _e,h as pe}from"./moment.672476b7.js";import{f as ve}from"./product.348d4254.js";var b={};Object.defineProperty(b,"__esModule",{value:!0});var me=ae.exports,fe=le;function B(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var he=B(me),ge=B(fe);let D=ge.default,k=null;const be=e=>{k=e},ye=()=>k=H;function xe(e,o){return!e||!o?e:e.replace(/\{(\w+)\}/g,(u,l)=>o[l])}const H=(...e)=>{const[o,u]=e;let l;const v=o.split(".");let g=D;for(let m=0,f=v.length;m<f;m++){const w=v[m];if(l=g[w],m===f-1)return xe(l,u);if(!l)return"";g=l}},De=(...e)=>k?k(...e)||H(...e):H(...e),F=e=>{console.warn(`[deprecation]:
      The previous i18n usage is deprecated please update to
      the new one to get reactive i18n translations, refer to:
      https://element-plus.org/#/en-US/component/i18n
    `),D=e||D,D.name&&he.default.locale(D.name)},Ve=F;b.i18n=be;b.restoreHandler=ye;b.setLocale=Ve;b.t=De;b.use=F;const V=e=>(re("data-v-e5b70c28"),e=e(),ie(),e),we={class:"crumbs"},Ce=V(()=>d("i",{class:"el-icon-lx-calendar"},null,-1)),ke=p(" \u89C4\u5219\u914D\u7F6E\u8868\u5BFC\u5165 "),Se=p("\u914D\u7F6E\u8868\u5BFC\u5165"),Ue={class:"container"},Ie={class:"handle-box"},je=p(" \u6E38\u620F\u9009\u62E9: "),Ee=p("\xA0 \u6E20\u9053\u9009\u62E9: "),Le=p("\xA0 \u7248\u672C\u9009\u62E9: "),Ne=p("\u914D\u7F6E\u8868\u5BFC\u5165\u5386\u53F2"),Te=V(()=>d("div",{class:"content-title"},"\u652F\u6301\u62D6\u62FD",-1)),qe=V(()=>d("i",{class:"el-icon-upload"},null,-1)),He=V(()=>d("div",{class:"el-upload__text"},[p(" \u5C06\u6587\u4EF6\u62D6\u5230\u6B64\u5904\uFF0C\u6216 "),d("em",null,"\u70B9\u51FB\u4E0A\u4F20")],-1)),Pe=V(()=>d("div",{class:"el-upload__tip"},"\u53EA\u80FD\u4E0A\u4F20 xlsx/xls \u6587\u4EF6",-1)),ze=p(" \u4E00\u952E\u4E0A\u4F20 "),Be={class:"pagination"},Fe={__name:"UploadExcel",setup(e){const o=_(""),u=_(""),l=_(""),v=_([]),g=_([]),m=_([]),f=_(1),w=_([]),S=_(ue),M=ne(),y=se({page_index:1,page_size:10}),P=_(1),O=()=>{ve().then(c=>{console.log("fetchVersionProductChannelData",c.data),v.value=c.data}).catch(()=>{})},Y=()=>{u.value="",l.value="",g.value=v.value.filter(c=>c.value==o.value)[0].children},J=()=>{l.value="",m.value=g.value.filter(c=>c.value==u.value)[0].children},R=()=>{o.value&&u.value&&l.value?(console.log("product_name_selected.value",o.value),console.log("channel_name_selected.value",u.value),console.log("version_name_selected.value",l.value),S.value.submit()):o.value?u.value?l.value||x.error("\u8BF7\u9009\u62E9\u7248\u672C\u53F7!"):x.error("\u8BF7\u9009\u62E9\u6E20\u9053!"):x.error("\u8BF7\u9009\u62E9\u6E38\u620F!")},A=c=>{if(f.value=2,o.value&&u.value&&l.value){let n=new FormData;n.append("file",c.file),n.append("product_id",o.value),n.append("channel",u.value),n.append("versions_b",l.value),de(n).then(i=>{i.status==200?(f.value=3,x.success(i.message),U(),S.value.clearFiles()):(x.error(i==null?void 0:i.message),f.value=1),setTimeout(()=>{f.value=1},3e3)}).catch(()=>{})}},G=()=>{console.log(o.value,u.value,l.value),localStorage.setItem("productoptions",JSON.stringify(v.value)),localStorage.setItem("channeloptions",JSON.stringify(v.value[0].children)),localStorage.setItem("versionoptions",JSON.stringify(m.value)),M.push({name:"configimporthistory"})},U=c=>{_e(c).then(n=>{P.value=n.data.total_count,w.value=n.data.lists.map(i=>({...i,import_status:i.import_status=="1"?"\u5BFC\u5165\u6210\u529F":"\u5BFC\u5165\u5931\u8D25",updated_at:pe(i.updated_at).format("YYYY-MM-DD HH:mm:ss")}))}).catch(()=>{})},K=c=>{y.page_index=c,U(y)};return O(),console.log("environment","development"),U(y),(c,n)=>{const i=r("el-breadcrumb-item"),Q=r("el-breadcrumb"),I=r("el-option"),j=r("el-select"),z=r("el-button"),E=r("el-step"),W=r("el-steps"),X=r("el-upload"),Z=r("el-divider"),L=r("el-table-column"),$=r("el-tag"),ee=r("el-table"),te=r("el-pagination");return h(),C("div",null,[d("div",we,[a(Q,{separator:"/"},{default:s(()=>[a(i,null,{default:s(()=>[Ce,ke]),_:1}),a(i,null,{default:s(()=>[Se]),_:1})]),_:1})]),d("div",Ue,[d("div",Ie,[je,a(j,{onChange:Y,style:{width:"13%"},modelValue:o.value,"onUpdate:modelValue":n[0]||(n[0]=t=>o.value=t),placeholder:"\u6E38\u620F\u9009\u62E9",class:"m-2"},{default:s(()=>[(h(!0),C(N,null,T(v.value,t=>(h(),q(I,{key:t.value,label:t.label_name,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),Ee,a(j,{onChange:J,style:{width:"13%"},modelValue:u.value,"onUpdate:modelValue":n[1]||(n[1]=t=>u.value=t),placeholder:"\u6E20\u9053\u9009\u62E9",class:"m-2"},{default:s(()=>[(h(!0),C(N,null,T(g.value,t=>(h(),q(I,{key:t.value,label:t.label_name,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),Le,a(j,{style:{width:"13%"},modelValue:l.value,"onUpdate:modelValue":n[2]||(n[2]=t=>l.value=t),placeholder:"\u7248\u672C\u9009\u62E9",class:"m-2"},{default:s(()=>[(h(!0),C(N,null,T(m.value,t=>(h(),q(I,{key:t.value,label:t.label_name,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),a(z,{type:"primary",style:{"margin-left":"260px"},onClick:G},{default:s(()=>[Ne]),_:1})]),a(W,{active:f.value,"finish-status":"success"},{default:s(()=>[a(E,{title:"\u9009\u62E9\u6587\u4EF6"}),a(E,{title:"\u5BFC\u5165\u6570\u636E"}),a(E,{title:"\u5BFC\u5165\u5B8C\u6210"})]),_:1},8,["active"]),Te,a(X,{class:"upload-demo",drag:"",multiple:"",action:"","auto-upload":!1,ref_key:"upload",ref:S,"http-request":A},{trigger:s(()=>[qe,He]),tip:s(()=>[Pe]),default:s(()=>[d("div",null,[a(z,{class:"ml-3",type:"primary",onClick:R},{default:s(()=>[ze]),_:1})])]),_:1},512),a(Z),a(ee,{data:w.value,border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:s(()=>[a(L,{prop:"file_name",label:"\u6587\u4EF6\u540D\u79F0"}),a(L,{prop:"import_status",label:"\u72B6\u6001"},{default:s(t=>[a($,{type:t.row.import_status==="\u5BFC\u5165\u6210\u529F"?"success":t.row.import_status==="\u5BFC\u5165\u5931\u8D25"?"danger":""},{default:s(()=>[p(ce(t.row.import_status),1)]),_:2},1032,["type"])]),_:1}),a(L,{prop:"updated_at",label:"\u5BFC\u5165\u65F6\u95F4"})]),_:1},8,["data"]),d("div",Be,[a(te,{background:"",layout:"total, prev, pager, next","current-page":y.page_index,"page-size":y.page_size,total:P.value,onCurrentChange:K},null,8,["current-page","page-size","total"])])])])}}};var Je=oe(Fe,[["__scopeId","data-v-e5b70c28"],["__file","/Users/apple/Desktop/github-c/project__c/src/views/UploadExcel.vue"]]);export{Je as default};
